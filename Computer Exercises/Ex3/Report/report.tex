\documentclass[11pt,a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[english]{babel}
% \usepackage[demo]{graphicx}

\title{
	Computer Exercise 1\\
	EL2520 Control Theory and Practice
}
\author{
	Jiaqi Li\\
	jiaqli@kth.se\\
	960326-1711
	\and
	Sifan Jiang\\
	sifanj@kth.se\\
	961220-8232
}

\newcommand{\image}[3]{
	\begin{figure}[!ht]
		\centering
	    \includegraphics[width=#1\textwidth]{#2}
		\caption{#3}
		\label{fig:#2}
	\end{figure}
}

% My packages
\usepackage{algorithm, algorithmic, listings} % Code
\usepackage{amsmath, amstext, amssymb, amsfonts, amsthm, dsfont, cancel, gensymb, mathtools, textcomp} % Math
\usepackage{color, xcolor} % Color
\usepackage{diagbox, tabularx} % Table
\usepackage{enumerate} % List
\usepackage{epsfig, epstopdf, graphicx, multicol, multirow, palatino, pgfplots, subcaption, tikz} % Image.
\usepackage{fancybox}
\usepackage{verbatim}

\usepackage[font=footnotesize]{caption} % labelfont=bf
\usepackage[font=scriptsize]{subcaption} % labelfont=bf
\usepackage[margin=1in]{geometry}
\usepackage[hidelinks]{hyperref}
\epstopdfsetup{outdir=./Figure/Converted/}
\graphicspath{{./Figure/}}

\makeatletter
\def\input@path{{./Figure/}}
\makeatother

\pgfplotsset{compat=1.13}

\begin{document}
\maketitle


%%%%%%%%%% Suppression of disturbances %%%%%%%%%%
\section*{Suppression of disturbances}
\par The weight is
	\begin{align*}
		W_S(s) &= \frac{1}{(s+\epsilon+i\sqrt{\omega^{2}-\epsilon^{2}})(s+\epsilon-i\sqrt{\omega^{2}-\epsilon^{2}})} \\
		&= \frac{1}{(s+0.5+i\sqrt{(100\pi)^{2}-0.5^{2}})(s+0.5-i\sqrt{(100\pi)^{2}-0.5^{2}})}
	\end{align*}

	\image{0.75}{suppressionOfDisturbanceResult}{Simulation results with system $G$, using $W_S$.}
	
	\begin{itemize}
		\item How much is the disturbance damped on the output?
		\par The rate between the output oscillations and the disturbance amplitude is $4.543\times 10^{-4}$.

		\item What amplification is required for a P-controller to get the same performance, and what are the disadvantages of such a controller?
		\par Since $|FG| \gg 1$, we have:
			\begin{align*}
				|S| &\approx |FG|^{-1} \\
				&= |FG(i 100\pi)|^{-1} \\
				&= (0.0920|F|)^{-1} \\
				&= 4.543\times 10^{-4}
			\end{align*}
		\par So, $|F|=\frac{1}{0.0920\times4.543\times 10^{-4}}=2.3926\times10^{4}$, which means the approximate amplification for a P-controller to get the same rate is $2.3926\times10^{4}$.
		\par The disadvantage of such a P-controller is that it's not feasible to get controllers with such big amplification.
	\end{itemize}


%%%%%%%%%% Robustness %%%%%%%%%%
\section*{Robustness}
	\begin{itemize}
		\item What is the condition on $T$ to guarantee stability according to the small gain theorem, and how can it be used to choose the weight $W_T$?
		\par Since $G_{0}(s) = G(s)(1 + \Delta_{G}(s))$, $\Delta_{G}(s) = -\frac{3}{s+2}$ is obtained. According to the small gain theorem,
			\begin{align*}
				|T(i\omega)\cdot\Delta_{G}(i\omega)| < 1 \Leftrightarrow |T(i\omega)| < |\Delta^{-1}_{G}(i\omega)|
			\end{align*}
		\par Also, according to eq. (5), to ensure $|T(i\omega)| \leq \gamma |W^{-1}_{T}(i\omega)|$ fulfilled, we let $|\Delta^{-1}_{G}(i\omega)| \leq \gamma |W^{-1}_{T}(i\omega)|$, thus obtain $ |W_{T}(i\omega)| \leq \gamma |\Delta_{G}(i\omega)| $. So, we can choose $ |W_{T}(i\omega)| = \gamma |\Delta_{G}(i\omega)| $. Setting $\gamma$ to $10^{-4}$, the weights are
			\begin{align*}
				W_S(s) &= \frac{1}{(s+0.5+i\sqrt{(100\pi)^{2}-0.5^{2}})(s+0.5-i\sqrt{(100\pi)^{2}-0.5^{2}})} \\
				W_T(s) &= 10^{-4}\frac{3}{s + 2}
			\end{align*}
			
		\item Is the small gain theorem fulfilled?
		\par According to fig~\ref{fig:robustnessBode}, small gain theorem $|T(i\omega)| < |\Delta^{-1}_{G}(i\omega)|$ is always fulfilled.
			\image{0.75}{robustnessBode}{Bode diagram showing that the small gain theorem is satisfied.}
			\image{0.75}{robustnessResult}{Simulation results with system $G_0$, using $W_S$ and $W_T$.}
		
		\item Compare the results to the previous simulation, which is illustrated in fig~\ref{fig:suppressionOfDisturbanceResult}, the rate between the output oscillations and the disturbance amplitude increases to $3.743\times 10^{-3}$.
	\end{itemize}



%%%%%%%%%% Control signal %%%%%%%%%%
\section*{Control signal}
\par The weights are
	\begin{align*}
		W_S(s) &= \frac{1}{(s+0.5+i\sqrt{(100\pi)^{2}-0.5^{2}})(s+0.5-i\sqrt{(100\pi)^{2}-0.5^{2}})} \\
		W_T(s) &= 10^{-4}\frac{3}{s + 2} \\
		W_U(s) &= \frac{0.5}{s + 2}
	\end{align*}

	\image{1}{controlSignalResult}{Simulation results with system $G_0$, using $W_S$, $W_T$ and $W_U$.}

\par Compare the results to the previous simulations, ????

\end{document}